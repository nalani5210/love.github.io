(function(){CodeMirror.extendMode("css",{commentStart:"/*",commentEnd:"*/",newlineAfterToken:function(a,b){return/^[;{}]$/.test(b)}});CodeMirror.extendMode("javascript",{commentStart:"/*",commentEnd:"*/",newlineAfterToken:function(b,c,a,d){if(this.jsonMode){return/^[\[,{]$/.test(c)||/^}/.test(a)}else{if(c==";"&&d.lexical&&d.lexical.type==")"){return false}return/^[;{}]$/.test(c)&&!/^;/.test(a)}}});CodeMirror.extendMode("xml",{commentStart:"<!--",commentEnd:"-->",newlineAfterToken:function(b,c,a){return b=="tag"&&/>$/.test(c)||/^</.test(a)}});CodeMirror.defineExtension("commentRange",function(b,e,d){var a=this,c=CodeMirror.innerMode(a.getMode(),a.getTokenAt(e).state).mode;a.operation(function(){if(b){a.replaceRange(c.commentEnd,d);a.replaceRange(c.commentStart,e);if(e.line==d.line&&e.ch==d.ch){a.setCursor(e.line,e.ch+c.commentStart.length)}}else{var h=a.getRange(e,d);var g=h.indexOf(c.commentStart);var f=h.lastIndexOf(c.commentEnd);if(g>-1&&f>-1&&f>g){h=h.substr(0,g)+h.substring(g+c.commentStart.length,f)+h.substr(f+c.commentEnd.length)}a.replaceRange(h,e,d)}})});CodeMirror.defineExtension("autoIndentRange",function(c,b){var a=this;this.operation(function(){for(var d=c.line;d<=b.line;d++){a.indentLine(d,"smart")}})});CodeMirror.defineExtension("autoFormatRange",function(h,j){var k=this;var o=k.getMode(),n=k.getRange(h,j).split("\n");var c=CodeMirror.copyState(o,k.getTokenAt(h).state);var g=k.getOption("tabSize");var e="",q=0,a=h.ch==0;function d(){e+="\n";a=true;++q}for(var f=0;f<n.length;++f){var m=new CodeMirror.StringStream(n[f],g);while(!m.eol()){var p=CodeMirror.innerMode(o,c);var b=o.token(m,c),l=m.current();m.start=m.pos;if(!a||/\S/.test(l)){e+=l;a=false}if(!a&&p.mode.newlineAfterToken&&p.mode.newlineAfterToken(b,l,m.string.slice(m.pos)||n[f+1]||"",p.state)){d()}}if(!m.pos&&o.blankLine){o.blankLine(c)}if(!a){d()}}k.operation(function(){k.replaceRange(e,h,j);for(var r=h.line+1,i=h.line+q;r<=i;++r){k.indentLine(r,"smart")}k.setSelection(h,k.getCursor(false))})})})();
